{"ast":null,"code":"import _slicedToArray from\"/Users/kamei/Desktop/Programs/Blockchain Project/KUChat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import NavBar from\"../parts/NavBar\";import ChatHeader from\"../parts/ChatHeader\";import QRCodeReader from\"../parts/QRCodeReader\";import{useLocation}from\"react-router-dom\";import getQueries from\"../../js/getQueries\";import getCommunicationHistory from\"../../js/getCommunicationHistory\";import isURL from\"../../js/isURL\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TransactionPage=function TransactionPage(props){var blockchain=props.blockchain;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var location=useLocation();var queries=getQueries(location);var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),rightAddress=_useState4[0],setMessage=_useState4[1];useEffect(function(){fetch(\"/get-address\").then(function(res){return res.json();}).then(function(data){return setMessage(data.public);});},[]);var leftAddress=queries.address;var tmpTransactions=getCommunicationHistory(blockchain,leftAddress,rightAddress);if(!queries.address){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(\"main\",{children:rightAddress?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container position-absolute top-50 start-50 translate-middle\",children:[/*#__PURE__*/_jsx(\"form\",{style:{width:\"100%\",margin:\"0 auto\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control\",name:\"address\",placeholder:\"\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\\u9001\\u4FE1\\u5148\\u306E\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u5165\\u529B\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",type:\"submit\",children:\"\\u6C7A\\u5B9A\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:function onClick(){return setState(!state);},\"data-bs-toggle\":\"modal\",\"data-bs-target\":\"#exampleModal\",style:{display:\"block\",width:\"134px\",height:\"134px\",margin:\"0 auto\",marginTop:\"30px\"},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-qr-code-scan\",style:{fontSize:\"5em\"}})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"exampleModal\",tabIndex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"exampleModalLabel\",children:\"QR Code \\u30EA\\u30FC\\u30C0\\u30FC\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"data-bs-dismiss\":\"modal\",\"aria-label\":\"Close\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:state?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(QRCodeReader,{}),/*#__PURE__*/_jsx(\"div\",{className:\"target-rect\"})]}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",\"data-bs-dismiss\":\"modal\",children:\"Close\"})})]})})})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Please sign in or sign up.\"}),/*#__PURE__*/_jsx(Link,{to:\"/signin\",className:\"btn btn-lg btn-primary mt-5\",children:\"Sign in / Sign up\"})]})})})]});}else if(queries.address){return/*#__PURE__*/_jsx(_Fragment,{children:rightAddress?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChatHeader,{className:\"chat-header\",address:queries.address}),/*#__PURE__*/_jsx(\"main\",{className:\"chat-main\",children:tmpTransactions.map(function(transaction){return transaction.fromAddress===rightAddress?/*#__PURE__*/_jsx(\"div\",{className:\"chat-sentence chat-sentence-right\",children:isURL(transaction.message)?/*#__PURE__*/_jsx(\"a\",{href:transaction.message,target:\"_blank\",rel:\"noreferrer\",children:transaction.message}):/*#__PURE__*/_jsx(_Fragment,{children:transaction.message})}):/*#__PURE__*/_jsx(\"div\",{className:\"chat-sentence chat-sentence-left\",children:transaction.message});})}),/*#__PURE__*/_jsx(\"footer\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-footer\",children:/*#__PURE__*/_jsxs(\"form\",{method:\"post\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"toAddress\",value:queries.address,style:{display:\"none\"}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"message\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"amount\",value:\"100\",style:{display:\"none\"}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-send-fill\"})})]})})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChatHeader,{className:\"chat-header\",address:queries.address}),/*#__PURE__*/_jsx(\"main\",{className:\"chat-main\",children:/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:\"white\"},children:\"Please sign in or sign up.\"}),/*#__PURE__*/_jsx(Link,{to:\"/signin\",className:\"btn btn-lg btn-success mt-5\",style:{color:\"white\"},children:\"Sign in / Sign up\"})]})})]})});}};export default TransactionPage;","map":{"version":3,"sources":["/Users/kamei/Desktop/Programs/Blockchain Project/KUChat/frontend/src/components/pages/TransactionPage.jsx"],"names":["React","useState","useEffect","Link","NavBar","ChatHeader","QRCodeReader","useLocation","getQueries","getCommunicationHistory","isURL","TransactionPage","props","blockchain","state","setState","location","queries","rightAddress","setMessage","fetch","then","res","json","data","public","leftAddress","address","tmpTransactions","width","margin","display","height","marginTop","fontSize","map","transaction","fromAddress","message","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport NavBar from \"../parts/NavBar\";\nimport ChatHeader from \"../parts/ChatHeader\";\nimport QRCodeReader from \"../parts/QRCodeReader\";\n\nimport { useLocation } from \"react-router-dom\";\nimport getQueries from \"../../js/getQueries\";\nimport getCommunicationHistory from \"../../js/getCommunicationHistory\";\nimport isURL from \"../../js/isURL\";\n\nconst TransactionPage = (props) => {\n  const { blockchain } = props;\n\n  const [state, setState] = useState(false);\n  let location = useLocation();\n  let queries = getQueries(location);\n\n  const [rightAddress, setMessage] = useState(\"\");\n  useEffect(() => {\n    fetch(\"/get-address\")\n      .then((res) => res.json())\n      .then((data) => setMessage(data.public));\n  }, []);\n\n  const leftAddress = queries.address;\n\n  let tmpTransactions = getCommunicationHistory(\n    blockchain,\n    leftAddress,\n    rightAddress\n  );\n\n  if (!queries.address) {\n    return (\n      <>\n        <NavBar />\n        <main>\n          {rightAddress ? (\n            <>\n              <div className=\"container position-absolute top-50 start-50 translate-middle\">\n                <form style={{ width: \"100%\", margin: \"0 auto\" }}>\n                  <div className=\"input-group mb-3\">\n                    <input\n                      type=\"search\"\n                      className=\"form-control\"\n                      name=\"address\"\n                      placeholder=\"メッセージ送信先のアドレスを入力\"\n                    />\n                    <button className=\"btn btn-outline-primary\" type=\"submit\">\n                      決定\n                    </button>\n                  </div>\n                </form>\n                <button\n                  className=\"btn btn-success\"\n                  onClick={() => setState(!state)}\n                  data-bs-toggle=\"modal\"\n                  data-bs-target=\"#exampleModal\"\n                  style={{\n                    display: \"block\",\n                    width: \"134px\",\n                    height: \"134px\",\n                    margin: \"0 auto\",\n                    marginTop: \"30px\",\n                  }}\n                >\n                  <i\n                    className=\"bi bi-qr-code-scan\"\n                    style={{ fontSize: \"5em\" }}\n                  ></i>\n                </button>\n              </div>\n\n              <div\n                className=\"modal fade\"\n                id=\"exampleModal\"\n                tabIndex=\"-1\"\n                aria-labelledby=\"exampleModalLabel\"\n                aria-hidden=\"true\"\n              >\n                <div className=\"modal-dialog\">\n                  <div className=\"modal-content\">\n                    <div className=\"modal-header\">\n                      <h5 className=\"modal-title\" id=\"exampleModalLabel\">\n                        QR Code リーダー\n                      </h5>\n                      <button\n                        type=\"button\"\n                        className=\"btn-close\"\n                        data-bs-dismiss=\"modal\"\n                        aria-label=\"Close\"\n                      ></button>\n                    </div>\n                    <div className=\"modal-body\">\n                      {state ? (\n                        <>\n                          <QRCodeReader />\n                          <div className=\"target-rect\" />\n                        </>\n                      ) : (\n                        <></>\n                      )}\n                    </div>\n                    <div className=\"modal-footer\">\n                      <button\n                        type=\"button\"\n                        className=\"btn btn-secondary\"\n                        data-bs-dismiss=\"modal\"\n                      >\n                        Close\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </>\n          ) : (\n            <>\n              <center>\n                <h2>Please sign in or sign up.</h2>\n                <Link to=\"/signin\" className=\"btn btn-lg btn-primary mt-5\">\n                  Sign in / Sign up\n                </Link>\n              </center>\n            </>\n          )}\n        </main>\n      </>\n    );\n  } else if (queries.address) {\n    return (\n      <>\n        {rightAddress ? (\n          <>\n            <ChatHeader className=\"chat-header\" address={queries.address} />\n            <main className=\"chat-main\">\n              {tmpTransactions.map((transaction) =>\n                transaction.fromAddress === rightAddress ? (\n                  <div className=\"chat-sentence chat-sentence-right\">\n                    {isURL(transaction.message) ? (\n                      <a\n                        href={transaction.message}\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                      >\n                        {transaction.message}\n                      </a>\n                    ) : (\n                      <>{transaction.message}</>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"chat-sentence chat-sentence-left\">\n                    {transaction.message}\n                  </div>\n                )\n              )}\n            </main>\n            <footer>\n              <div className=\"chat-footer\">\n                <form method=\"post\">\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    name=\"toAddress\"\n                    value={queries.address}\n                    style={{ display: \"none\" }}\n                  />\n                  <input type=\"text\" className=\"form-control\" name=\"message\" />\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    name=\"amount\"\n                    value=\"100\"\n                    style={{ display: \"none\" }}\n                  />\n                  <button type=\"submit\" className=\"btn btn-success\">\n                    <i className=\"bi bi-send-fill\"></i>\n                  </button>\n                </form>\n              </div>\n            </footer>\n          </>\n        ) : (\n          <>\n            <ChatHeader className=\"chat-header\" address={queries.address} />\n            <main className=\"chat-main\">\n              <center>\n                <h2 style={{ color: \"white\" }}>Please sign in or sign up.</h2>\n                <Link\n                  to=\"/signin\"\n                  className=\"btn btn-lg btn-success mt-5\"\n                  style={{ color: \"white\" }}\n                >\n                  Sign in / Sign up\n                </Link>\n              </center>\n            </main>\n          </>\n        )}\n      </>\n    );\n  }\n};\n\nexport default TransactionPage;\n"]},"metadata":{},"sourceType":"module"}