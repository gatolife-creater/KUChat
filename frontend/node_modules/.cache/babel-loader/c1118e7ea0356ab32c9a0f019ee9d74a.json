{"ast":null,"code":"import _slicedToArray from\"/Users/kamei/Desktop/Programs/Blockchain Project/KUChat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import NavBar from\"../parts/NavBar\";import ChatHeader from\"../parts/ChatHeader\";import QRCodeReader from\"../parts/QRCodeReader\";import{useLocation}from\"react-router-dom\";import getQueries from\"../../js/getQueries\";import getCommunicationHistory from\"../../js/getCommunicationHistory\";import isURL from\"../../js/isURL\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var TransactionPage=function TransactionPage(props){var blockchain=props.blockchain;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var location=useLocation();var queries=getQueries(location);var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),rightAddress=_useState4[0],setMessage=_useState4[1];useEffect(function(){fetch(\"/get-address\").then(function(res){return res.json();}).then(function(data){return setMessage(data.public);});},[]);var leftAddress=queries.address;var tmpTransactions=getCommunicationHistory(blockchain,leftAddress,rightAddress);if(!queries.address){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(\"main\",{children:rightAddress?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container position-absolute top-50 start-50 translate-middle\",children:[/*#__PURE__*/_jsx(\"form\",{style:{width:\"100%\",margin:\"0 auto\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control\",name:\"address\",placeholder:\"\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\\u9001\\u4FE1\\u5148\\u306E\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u5165\\u529B\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",type:\"submit\",children:\"\\u6C7A\\u5B9A\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:function onClick(){return setState(!state);},\"data-bs-toggle\":\"modal\",\"data-bs-target\":\"#exampleModal\",style:{display:\"block\",width:\"134px\",height:\"134px\",margin:\"0 auto\",marginTop:\"30px\"},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-qr-code-scan\",style:{fontSize:\"5em\"}})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"exampleModal\",tabIndex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"exampleModalLabel\",children:\"QR Code \\u30EA\\u30FC\\u30C0\\u30FC\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"data-bs-dismiss\":\"modal\",\"aria-label\":\"Close\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:state?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(QRCodeReader,{}),/*#__PURE__*/_jsx(\"div\",{className:\"target-rect\"})]}):/*#__PURE__*/_jsx(_Fragment,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",\"data-bs-dismiss\":\"modal\",children:\"Close\"})})]})})})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Please sign in or sign up.\"}),/*#__PURE__*/_jsx(Link,{to:\"/signin\",className:\"btn btn-lg btn-primary mt-5\",children:\"Sign in / Sign up\"})]})})})]});}else if(queries.address){return/*#__PURE__*/_jsx(_Fragment,{children:rightAddress?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChatHeader,{className:\"chat-header\",address:queries.address}),/*#__PURE__*/_jsx(\"main\",{className:\"chat-main\",children:tmpTransactions.map(function(transaction){return transaction.fromAddress===rightAddress?/*#__PURE__*/_jsx(\"div\",{className:\"chat-sentence chat-sentence-right\",children:isURL(transaction.message)?/*#__PURE__*/_jsx(\"a\",{href:transaction.message,target:\"_blank\",rel:\"noreferrer\",children:transaction.message}):/*#__PURE__*/_jsx(_Fragment,{children:transaction.message})}):/*#__PURE__*/_jsx(\"div\",{className:\"chat-sentence chat-sentence-left\",children:transaction.message});})}),/*#__PURE__*/_jsx(\"footer\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-footer\",children:/*#__PURE__*/_jsxs(\"form\",{method:\"post\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"toAddress\",value:queries.address,style:{display:\"none\"}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"message\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"amount\",value:\"100\",style:{display:\"none\"}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-send-fill\"})})]})})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChatHeader,{className:\"chat-header\",address:queries.address}),/*#__PURE__*/_jsx(\"main\",{className:\"chat-main\",children:/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:\"white\"},children:\"Please sign in or sign up.\"}),/*#__PURE__*/_jsx(Link,{to:\"/signin\",className:\"btn btn-lg btn-success mt-5\",style:{color:\"white\"},children:\"Sign in / Sign up\"})]})})]})});}};export default TransactionPage;","map":{"version":3,"sources":["/Users/kamei/Desktop/Programs/Blockchain Project/KUChat/frontend/src/components/pages/TransactionPage.jsx"],"names":["React","useState","useEffect","Link","NavBar","ChatHeader","QRCodeReader","useLocation","getQueries","getCommunicationHistory","isURL","TransactionPage","props","blockchain","state","setState","location","queries","rightAddress","setMessage","fetch","then","res","json","data","public","leftAddress","address","tmpTransactions","width","margin","display","height","marginTop","fontSize","map","transaction","fromAddress","message","color"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport NavBar from \"../parts/NavBar\";\nimport ChatHeader from \"../parts/ChatHeader\";\nimport QRCodeReader from \"../parts/QRCodeReader\";\n\nimport { useLocation } from \"react-router-dom\";\nimport getQueries from \"../../js/getQueries\";\nimport getCommunicationHistory from \"../../js/getCommunicationHistory\";\nimport isURL from \"../../js/isURL\";\n\nconst TransactionPage = (props) => {\n    const {blockchain} = props;\n\n    const [state, setState] = useState(false);\n    let location = useLocation();\n    let queries = getQueries(location);\n\n    const [rightAddress, setMessage] = useState(\"\");\n    useEffect(()=>{\n        fetch(\"/get-address\")\n        .then((res)=>res.json())\n        .then((data)=>setMessage(data.public));\n    },[])\n\n    const leftAddress = queries.address;\n\n    let tmpTransactions = getCommunicationHistory(blockchain, leftAddress, rightAddress);\n\n    if(!queries.address){\n        return(\n            <>\n                <NavBar/>\n                <main>\n                    {rightAddress?  <>\n                                        <div className=\"container position-absolute top-50 start-50 translate-middle\">\n                                            <form style={{width: \"100%\", margin: \"0 auto\"}}>\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"search\" className=\"form-control\" name=\"address\" placeholder=\"メッセージ送信先のアドレスを入力\"/>\n                                                    <button className=\"btn btn-outline-primary\" type=\"submit\">決定</button>\n                                                </div>\n                                            </form>\n                                            <button className=\"btn btn-success\" onClick={() => setState(!state)} data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\" style={{display:\"block\", width:\"134px\", height:\"134px\", margin:\"0 auto\", marginTop:\"30px\"}}>\n                                                <i className=\"bi bi-qr-code-scan\" style={{fontSize:\"5em\"}}></i>\n                                            </button>\n                                        </div>\n                        \n                                        <div className=\"modal fade\" id=\"exampleModal\" tabIndex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                                            <div className=\"modal-dialog\">\n                                                <div className=\"modal-content\">\n                                                    <div className=\"modal-header\">\n                                                        <h5 className=\"modal-title\" id=\"exampleModalLabel\">QR Code リーダー</h5>\n                                                        <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                                                    </div>\n                                                    <div className=\"modal-body\">\n                                                        {state ? <>\n                                                                    <QRCodeReader/>\n                                                                    <div className=\"target-rect\"/>\n                                                                </>\n                                                                : <></>}\n                                                    </div>\n                                                    <div className=\"modal-footer\">\n                                                        <button type=\"button\" className=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </>\n                                :   <>\n                                        <center>\n                                            <h2>Please sign in or sign up.</h2>\n                                            <Link to=\"/signin\" className=\"btn btn-lg btn-primary mt-5\">Sign in / Sign up</Link>\n                                        </center> \n                                    </>}\n                    \n                </main>\n            </>\n        )\n    }else if(queries.address){\n        return(\n            <>\n                {rightAddress?  <>\n                                    <ChatHeader className=\"chat-header\" address={queries.address}/>\n                                    <main className=\"chat-main\">\n                                        {tmpTransactions.map((transaction)=>(\n                                            transaction.fromAddress === rightAddress ? <div className=\"chat-sentence chat-sentence-right\">\n                                                                                            {isURL(transaction.message)? <a href={transaction.message} target=\"_blank\" rel=\"noreferrer\">{transaction.message}</a>\n                                                                                                                    : <>{transaction.message}</>}\n                                                                                        </div>\n                                                                                    : <div className=\"chat-sentence chat-sentence-left\">{transaction.message}</div> \n                                        ))}\n                                    </main>\n                                    <footer>\n                                        <div className=\"chat-footer\">\n                                            <form method=\"post\">\n                                                <input type=\"text\" className=\"form-control\" name=\"toAddress\" value={queries.address} style={{display:\"none\"}}/>\n                                                <input type=\"text\" className=\"form-control\" name=\"message\"/>\n                                                <input type=\"text\" className=\"form-control\" name=\"amount\" value=\"100\" style={{display:\"none\"}}/>\n                                                <button type=\"submit\" className=\"btn btn-success\">\n                                                    <i className=\"bi bi-send-fill\"></i>\n                                                </button>\n                                            </form>\n                                        </div>\n                                    </footer>\n                                </>\n                            :   <>\n                                    <ChatHeader className=\"chat-header\" address={queries.address}/>\n                                    <main className=\"chat-main\">\n                                        <center>\n                                            <h2 style={{color:\"white\"}}>Please sign in or sign up.</h2>\n                                            <Link to=\"/signin\" className=\"btn btn-lg btn-success mt-5\" style={{color:\"white\"}}>Sign in / Sign up</Link>\n                                        </center> \n                                    </main>\n                                </>}\n                \n            </>\n        )\n    }  \n}\n\nexport default TransactionPage;"]},"metadata":{},"sourceType":"module"}